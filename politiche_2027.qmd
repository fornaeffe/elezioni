---
title: "Elezioni politiche 2027"
author: "Luca Fornasari"
date: "`r Sys.Date()`"
format: 
  html:
    self-contained: true
---

Simulazione delle prossime elezioni
politiche, ottenuta
partendo dai risultati delle elezioni europee 2024.
Vengono eseguite 1000 simulazioni, in ciascuna di esse le percentuali che ciascuna
lista ha preso alle elezioni europee in ciascuna provincia 
vengono aumentate o diminuite casualmente di una quantità che sia coerente
con la variabilità che ha avuto nel passato la percentuale di quella lista.
Per i dettagli vedere in fondo negli approfondimenti.

Avverto che ho fatto questa simulazione per curiosità e non per lavoro, e che
potrebbero essermi sfuggiti degli errori nel processo di
simulazione, i risultati vanno dunque presi senza alcuna garanzia di
accuratezza.

Segnalazioni, richieste e suggerimenti a <fornaeffe@gmail.com> o sul repository
<https://github.com/fornaeffe/elezioni-EMR>.

```{r setup}
#| include: false
knitr::opts_chunk$set(echo = FALSE)

library(data.table)

# Carico il "pacchetto"
files.sources = list.files("R", full.names = TRUE, recursive = TRUE)
invisible(sapply(files.sources, source))

scenario <- "scenari/politiche_2027.xlsx"

data_elezione <- as.POSIXct("2027-03-01")

simulazioni <- 1000

frazione_uni_in_pluri <- 0.35

frazioni_pluricandidature <- c(0.8, 0.1, 0.05, 0.03, 0.02)

```

```{r simulazione}
#| include: false
#| cache: true
#| message: false

risultato <- simula_politiche(
  scenario,
  data_elezione,
  frazione_uni_in_pluri,
  frazioni_pluricandidature,
  simulazioni
)

```

## Dati
Di seguito le liste che si ipotizza si presentino alle prossime elezioni,
insieme con il loro risultato alle ultime elezioni. Per le liste che alle passate
elezioni erano presenti sotto diverso nome è stato stimato il risultato 
partendo da liste affini.
```{r}
tabella_dati(risultato$camera)
```

### Percentuali per lista

Questo grafico mostra le percentuali simulate per ciascuna 
lista.
```{r}
boxplot_percentuali(risultato$camera)
```



### Numero di seggi rispetto alle percentuali ottenute

I grafici seguenti riportano il numero di seggi ottenuti rispetto alla percentuale
di voti validi ottenuta. Ogni punto corrisponde ad una simulazione, dove il colore
è più accesso il risultato è più probabile (più simulazioni hanno ottenuto lo
stesso risultato).

#### Camera dei Deputati

```{r}
eletti_percentuale_xyplots_liste(risultato$camera)

```

Nei grafici seguenti è mostrato il numero di eletti per ogni coalizione.

```{r}
eletti_percentuale_xyplots_coalizioni(risultato$camera, colonna_percentuale = "PERCENTUALE_LISTA")
```

#### Senato

```{r}
eletti_percentuale_xyplots_liste(risultato$senato)

```

Nei grafici seguenti è mostrato il numero di eletti per ogni coalizione.

```{r}
eletti_percentuale_xyplots_coalizioni(risultato$senato, colonna_percentuale = "PERCENTUALE_LISTA")
```

### Spinogrammi degli eletti

Nei grafici seguenti ogni colonna rappresenta i numeri di seggi che la lista può
ottenere se prende una percentuale compresa tra i due estremi della colonna.
Ad esempio, se la colonna tra le percentuali 3 e 4 comprende due celle di 
dimensioni simili, con scritto 1 e 2, significa che se la lista prende tra il 3%
e il 4% può eleggere uno o due parlamentari, e queste due possibilità hanno 
probabilità simili. Ad area uguale corrisponde una uguale probabilità di ottenere
quei risultati.

#### Camera

```{r}
grafici_eletti(risultato$camera)
```

#### Senato

```{r}
grafici_eletti(risultato$senato)
```

### Probabilità di elezione nel collegio di Parma

```{r}

grafico_eletti_pluri(risultato$camera, "Alleanza Verdi Sinistra", "80001")
```




# Approfondimenti

{{< include _spiegazione_metodo.qmd >}}

```{r}
#| fig.width: 8
#| fig-height: 8
#| dpi: 100


par(mar=c(15.1, 4.1, 4.1, 2.1), xpd=TRUE)
andamento_passato(risultato$camera)
```

La tabella seguente mostra le liste passate usate per stimare la percentuale
di elettori che voteranno per ciascuna lista alle future elezioni.
La colonna "frazione" indica la frazione degli elettori che hanno votato la "LISTA"
alle passate elezioni che potrebbero votare la "LISTA FUTURA" alle future elezioni.

```{r}
tabella_flussi(risultato$camera)
```